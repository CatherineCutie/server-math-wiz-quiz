import{u as N,r as l,j as e,Y as S,c as u}from"./app-DtDMgu8o.js";import{G as z,u as q,T as E}from"./Table-C-poGafV.js";import{A as L}from"./AuthenticatedLayout-BXsNt2yu.js";import{S as B}from"./Sidebar-DH7zAeLu.js";import"./ApplicationLogo-eMIQY_J6.js";import"./transition-Ch4ShWBt.js";function m(o){return z({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"},child:[]},{tag:"path",attr:{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"},child:[]}]})(o)}const T=({auth:o})=>{var d;const{selectedMenu:x,setSelectedMenu:h,setQuizScoreData:p,quizScoreData:j}=N(),[g,r]=l.useState(!1);l.useEffect(()=>{h("quiz")},[]);const c=[{name:"quiz",id:1}],f=async s=>{try{const{data:a}=await u.get("/api/getScoresByQuizId/"+s);return p(a),console.log(a),a}catch(a){console.error(a)}},n=q({queries:c.map(s=>({queryKey:["fetchDataQuiz"+s.id],queryFn:()=>f(s.id)}))}),b=n.some(s=>s.isLoading),w=n.some(s=>s.isError),i=((d=n.find(s=>s.data))==null?void 0:d.data)||[],v=async()=>{r(!0);try{const s=await u.post("/api/download-quiz-csv",j,{responseType:"blob"}),y=`quiz_scores_${new Date().toISOString().slice(0,10)}.csv`,D=window.URL.createObjectURL(new Blob([s.data])),t=document.createElement("a");t.href=D,t.setAttribute("download",y),document.body.appendChild(t),t.click(),setTimeout(()=>{r(!1)},6e3)}catch(s){r(!1),console.error("Error downloading the CSV:",s)}};return e.jsxs(L,{user:o.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Dashboard"}),children:[e.jsx(S,{title:"Dashboard"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsx("h1",{className:"font-bold text-2xl uppercase",children:x}),e.jsx("div",{className:"divider"}),e.jsxs("div",{className:"flex gap-10",children:[e.jsx(B,{items:c}),e.jsxs("div",{className:"overflow-x-auto flex-1",children:[e.jsx("div",{className:"flex justify-end",children:Object.keys(i).length===0&&i.constructor===Object?null:e.jsx(e.Fragment,{children:g?e.jsxs("button",{className:"btn btn-primary btn-sm",disabled:!0,children:[e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Download",e.jsx(m,{size:15})]}):e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:v,children:["Download",e.jsx(m,{size:15})]})})}),b?e.jsx("p",{children:"Loading..."}):w?e.jsx("p",{children:"Error loading data."}):e.jsx(E,{data:i})]})]})]})})})})]})};export{T as default};
